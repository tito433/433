<!DOCTYPE html>
<html lang="en">
<head>
  <title>Data graber from google calendar</title>
  <style>
  	html,body{padding: 0;margin: 0;height: 100%;}
    #authorize-div{
      width: 300px;
    margin: 200px auto;
    padding: 50px;
    border: 1px solid #ff0;
    text-align: center;
    }button{    margin: 20px auto;}
  </style>
</head>
<body>
  	<div id="authorize-div">
      <span>Authorize access to Google Calendar API</span>
      <!--Button for the user to click to initiate auth sequence -->
      <button id="authorize-button" onclick="glAuthorizeMe(event)">
        Authorize
      </button>
    </div>
    <script type="text/javascript">
      // Your Client ID can be retrieved from your project in the Google
      // Developer Console, https://console.developers.google.com
      var CLIENT_ID = '169881026239-62ks55c662hlrf6hnkui6uspmom0mj9i.apps.googleusercontent.com';

      var SCOPES = ["https://www.googleapis.com/auth/calendar.readonly"];

      /**
       * Check if current user has authorized this application.
       */
      function glAuthorizeMe() {
        gapi.auth.authorize({
            'client_id': CLIENT_ID,
            'scope': SCOPES.join(' '),
            'immediate': true
          }, function(authResult) {
              var authorizeDiv = document.getElementById('authorize-div');
              if (authResult && !authResult.error) {
                // Hide auth UI, then load client library.
                authorizeDiv.style.display = 'none';
                gapi.client.load('calendar', 'v3', getAllEvents);
              } else {
                console.log(authResult);
                authorizeDiv.appendChild(document.createElement('br'));
                authorizeDiv.appendChild(document.createTextNode("Error:"+authResult.error+","+authResult.error_subtype));
              }
            }
        );
      }




      /**
       * Print the summary and start datetime/date of the next ten events in
       * the authorized user's calendar. If no events are found an
       * appropriate message is printed.
       */
      function getAllEvents() {
        var date_from=new Date("01 Jan 2014"),
            date_to=new Date();
            date_to.setDate(date_to.getDate() + 1); //till tomorrow?

        gapi.client.calendar.events.list({
          'calendarId': 'primary',
          'timeMin': date_from.toISOString(),'timeMax': date_to.toISOString(),
          'showDeleted': false, 'singleEvents': true,
          'maxResults': 999999,'orderBy': 'startTime'
        }).execute(function(resp) {
          document.open("text/html", "replace");
          var events = resp.items;
          document.write(JSON.stringify(resp));
          if (events.length > 0) {
            
          } else {
            document.write("No events found!");
          }
          document.close();

        });
      }
    </script>
    <script src="https://apis.google.com/js/client.js?onload=glAuthorizeMe"></script>
</body>
</html>